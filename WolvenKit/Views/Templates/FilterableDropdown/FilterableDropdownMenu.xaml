<UserControl
    x:Class="WolvenKit.Views.Editors.FilterableDropdownMenu"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:helpers="clr-namespace:WolvenKit.Functionality.Helpers"
    xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
    FocusManager.FocusedElement="{Binding ElementName=filterTextBox}">
    <Grid>
        <Grid.Resources>
            <ResourceDictionary>
                <Style
                    BasedOn="{StaticResource WolvenkitDialogLabelStyleMedium}"
                    TargetType="{x:Type Label}" />
                <Style TargetType="{x:Type Grid}">
                    <Setter Property="Background" Value="{StaticResource BackgroundColor_Control}" />
                </Style>
            </ResourceDictionary>

        </Grid.Resources>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{DynamicResource WolvenKitDialogLabelColumnWidthMedium}">
                <ColumnDefinition.Style>
                    <Style TargetType="ColumnDefinition">
                        <Style.Triggers>
                            <DataTrigger
                                Binding="{Binding IsShowLabel}"
                                Value="False">
                                <Setter Property="Width" Value="0" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ColumnDefinition.Style>
            </ColumnDefinition>

            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition MinHeight="{DynamicResource WolvenKitRedEditorRowMinHeight}" />
            <RowDefinition x:Name="dropdownRow">
                <RowDefinition.Style>
                    <Style TargetType="RowDefinition">
                        <Style.Triggers>
                            <DataTrigger
                                Binding="{Binding IsInline}"
                                Value="True">
                                <Setter Property="Height" Value="0" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </RowDefinition.Style>
            </RowDefinition>
        </Grid.RowDefinitions>

        <!-- ====================================== -->
        <!-- Label -->
        <!-- ====================================== -->
        <Label
            Grid.Row="0"
            Grid.Column="0"
            Width="{StaticResource WolvenKitLabelWidthMedium}"
            HorizontalAlignment="Left"
            Background="#252525"
            BorderThickness="0"
            Foreground="White"
            FontSize="{DynamicResource WolvenKitFontSubTitle}"
            Content="{Binding Label}" />


        <!-- Original layout elements (with x:Name for toggling) -->
        <syncfusion:SfTextBoxExt
            x:Name="filterTextBox"
            Grid.Row="0"
            Grid.Column="1"
            Grid.ColumnSpan="2"
            Margin="0,0,1,1"
            VerticalContentAlignment="Center"
            Background="{DynamicResource BackgroundColor_Control}"
            FontSize="{DynamicResource WolvenKitFontSubTitle}"
            helpers:TextBoxBehavior.TripleClickSelectAll="True"
            KeyboardNavigation.TabIndex="-1"
            Watermark="Filter"
            WatermarkTemplate="{StaticResource PlaceholderTemplate}"
            Text="{Binding FilterText,
                           UpdateSourceTrigger=PropertyChanged}">
            <syncfusion:SfTextBoxExt.Style>
                <Style
                    BasedOn="{StaticResource {x:Type syncfusion:SfTextBoxExt}}"
                    TargetType="syncfusion:SfTextBoxExt">
                    <Style.Triggers>
                        <DataTrigger
                            Binding="{Binding IsInline}"
                            Value="True">
                            <Setter Property="Grid.ColumnSpan" Value="1" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </syncfusion:SfTextBoxExt.Style>
        </syncfusion:SfTextBoxExt>

        <ComboBox
            x:Name="dropdown"
            Grid.Row="1"
            Grid.Column="1"
            Grid.ColumnSpan="2"
            Width="Auto"
            MinWidth="{DynamicResource WolvenkitControlMinWidth}"
            MaxWidth="1000"
            Background="{DynamicResource BackgroundColor_Control}"
            FontSize="{DynamicResource WolvenKitFontSubTitle}"
            ItemsSource="{Binding FilteredOptions,
                                  Mode=OneWay}"
            KeyboardNavigation.TabIndex="-1"
            SelectedValuePath="Value"
            DisplayMemberPath="Key"
            SelectedValue="{Binding SelectedOption}">
            <ComboBox.Style>
                <Style
                    BasedOn="{StaticResource {x:Type ComboBox}}"
                    TargetType="ComboBox">
                    <Style.Triggers>
                        <DataTrigger
                            Binding="{Binding IsInline}"
                            Value="True">
                            <Setter Property="Grid.Column" Value="2" />
                            <Setter Property="Grid.ColumnSpan" Value="1" />
                            <Setter Property="Grid.Row" Value="0" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ComboBox.Style>
        </ComboBox>
    </Grid>
</UserControl>
